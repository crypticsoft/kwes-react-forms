import{jsxs as u,jsx as l,Fragment as E}from"react/jsx-runtime";import*as f from"react";import x,{forwardRef as I,useRef as j,Fragment as M}from"react";const g=({help:e,children:a})=>u("div",{className:"field",children:[l("div",{className:"control",children:a}),e&&l("p",{className:"help",children:e})]}),R=({className:e,help:a,label:r,...n})=>l(g,{help:a,label:r,children:u("label",{className:e,children:[n.children," Â ",r]})}),V=({value:e,rules:a,name:r,checked:n,...s})=>l("input",{name:r,type:"checkbox",checked:n,value:e,...s}),C=({name:e,label:a,rules:r,help:n,className:s,...i})=>l(R,{name:e,label:a,rules:r,help:n,className:s,children:l(V,{name:e,...i})}),_=e=>{var r;f.useState(new Array(Object.entries(e.options).length).fill(!1));const a=(r=e==null?void 0:e.rules)!=null&&r.includes("required")?"label required":"label";return l(g,{label:e.label,help:e.help,children:u("fieldset",{"data-kw-group":!0,className:"kw-checkbox-group",rules:e.rules,children:[l("legend",{className:a,children:e.label}),e.options&&Object.entries(e.options).map(([n,s],i)=>l(C,{name:e.name,value:s,label:n},`${e.name}-${i}`))]})})};function S(e){const[a,r]=f.useState(!1);return f.useEffect(()=>{const n=new MutationObserver(function(s){for(const i of s)i.type==="attributes"&&(i.target.classList.contains("kw-border-error")&&r(!0),i.target.classList.contains("kw-border-success")&&r(!1))});return e.current&&n.observe(e.current,{attributes:!0,childList:!1,subtree:!1}),()=>{n.disconnect()}}),a}const L=I((e,a)=>l("input",{ref:a,id:`${e.name}-input`,"data-testid":`${e.name}-input`,className:["input",e.className?e.className:""].join(" ").trim(),...e}));L.displayName="InputField";const w=e=>{var i,t;const a=j(null),r=S(a),n={"aria-describedby":`field-error-${e.name}`,"aria-invalid":r||""},s=(i=e==null?void 0:e.rules)!=null&&i.includes("required")?"label required":"label";return l(g,{label:e.label,help:e.help,children:u(M,{children:[e.type!=="hidden"&&l("label",{className:s,htmlFor:`${e.name}-input`,children:e.label}),l(L,{ref:a,id:`${e.name}-input`,"data-testid":`${e.name}-input`,rules:e.rules,...e.type!=="hidden"&&r&&{...n},...e,required:!!((t=e==null?void 0:e.rules)!=null&&t.includes("required"))})]})})},A=({name:e,label:a,onChange:r,value:n})=>l(E,{children:u("label",{children:[l("input",{onChange:r,type:"radio",name:e,value:n})," ",a]},a)}),G=e=>{var r;const a=(r=e==null?void 0:e.rules)!=null&&r.includes("required")?"label required":"label";return u("div",{className:"field",children:[l("div",{className:"control radio-control",children:u("fieldset",{"data-kw-group":!0,...e.rules&&{rules:e.rules},children:[l("legend",{className:a,children:e.label}),Object.entries(e.options).map(([n,s])=>l(A,{label:n,name:e.name,value:s,options:{[n]:s},onChange:e.onChange},n))]})}),e.help&&l("p",{className:"help",children:e.help})]})},H=({name:e,label:a,rules:r,defaultOption:n,help:s,options:i})=>{const[t,c]=f.useState(n||""),m=f.useRef(0),p=S(m),b={"aria-describedby":`field-error-${e}`,"aria-invalid":p||""},N=r!=null&&r.includes("required")?"label required":"label";return u("div",{className:"field",children:[l("label",{className:N,htmlFor:`${e}-select`,children:a}),l("div",{className:"control is-fullwidth select "+(p?"has-error is-danger":""),children:u("select",{ref:m,id:`${e}-select`,name:e,value:t,rules:r,onChange:h=>c(h.currentTarget.value),...b,children:[!n&&l("option",{value:"",children:"Select One"}),n!==void 0&&typeof n=="object"&&l("option",{value:Object.values(n)[0].value,children:Object.keys(n)[0]}),Object.entries(i).map(([h,k])=>l("option",{value:k.value,children:h},h))]})}),s&&l("p",{className:"help",children:s})]})},P=({rules:e,label:a,help:r,className:n,...s})=>{const[i,t]=x.useState(s.defaultValue||""),c=j(null),m=S(c),p={"aria-describedby":`field-error-${s.name}`},b=e!=null&&e.includes("required")?"label required":"label";return u(g,{help:r,label:a,children:[s.type!=="hidden"&&l("label",{className:b,htmlFor:`${s.name}-input`,children:a}),l("textarea",{ref:c,id:`${s.name}-textarea`,"data-testid":`${s.name}-textarea`,name:s.name,className:["textarea",s.type,n].join(" "),onChange:N=>t(N.currentTarget.value),...e?{rules:e}:{},...m?{...p}:{},placeholder:s.placeholder,value:i||""})]})},o=({className:e,help:a,label:r,...n})=>u(g,{help:a,label:r,children:[l("label",{className:[e,"label"].join(" "),htmlFor:n.name,children:r}),l("p",{children:n.children})]}),B=({value:e,rules:a,name:r,checked:n,...s})=>l("input",{name:r,type:"file",className:"input",value:e,rules:a,...s}),J=({name:e,label:a,rules:r,help:n,className:s,...i})=>l(o,{name:e,label:a,rules:r,help:n,className:s,children:l(B,{name:e,rules:r,...i})}),K=({min:e,max:a,value:r,rules:n,name:s,checked:i,...t})=>l("input",{name:s,type:"date",className:"input",value:r,min:e,max:a,rules:n,...t}),Q=({name:e,label:a,rules:r,help:n,className:s,...i})=>l(o,{name:e,label:a,rules:r,help:n,className:[s,"kw-datepicker-wrapper"].join(" "),children:l(K,{name:e,rules:r,...i})}),U=({value:e,rules:a,name:r,checked:n,...s})=>l("div",{className:"kw-datepicker-wrapper",children:l("input",{name:r,type:"datepicker",value:e,className:"input",rules:a,...s})}),W=({name:e,label:a,rules:r,help:n,className:s,...i})=>l(o,{name:e,label:a,rules:r,help:n,className:s,children:l(U,{name:e,rules:r,...i})}),X=({min:e,max:a,rules:r,name:n,...s})=>{const[i,t]=x.useState(null);return l("input",{type:"datetime-local",className:"input",name:n,value:i||"",min:e,max:a,rules:r,onChange:c=>t(c.currentTarget.value),...s})},Y=({name:e,min:a,max:r,label:n,rules:s,help:i,className:t,...c})=>l(o,{name:e,label:n,rules:s,help:i,className:[t,"kw-datepicker-wrapper"].join(" "),children:l(X,{name:e,min:a,rules:s,max:r,...c})}),Z=({min:e,max:a,value:r,rules:n,name:s,checked:i,...t})=>l("input",{name:s,type:"time",className:"input timepicker",value:r,min:e,max:a,rules:n,...e&&a&&{title:`Time should be between ${new Date(`${new Date().toLocaleString().split(",").shift()} ${e}`).toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0})} and ${new Date(`${new Date().toLocaleString().split(",").shift()} ${a}`).toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0})}`},...t}),ee=({name:e,label:a,rules:r,help:n,className:s,...i})=>l(o,{name:e,label:a,rules:r,help:n,className:[s,"kw-timepicker-wrapper"].join(" "),children:l(Z,{name:e,rules:r,...i})}),le=({help:e,value:a,rules:r,name:n,pattern:s,checked:i,...t})=>l("input",{name:n,type:"tel",className:"input input-tel",value:a,rules:r,pattern:s,"aria-label":e,...t}),ae=({name:e,label:a,rules:r,help:n,className:s,...i})=>l(o,{name:e,label:a,rules:r,help:n,className:[s,"kw-tel-wrapper"].join(" "),children:l(le,{name:e,rules:r,help:n,...i})}),re=({min:e,max:a,rules:r,name:n,checked:s,...i})=>{const[t,c]=x.useState(null);return l("input",{name:n,type:"range",value:t,rules:r,min:e,max:a,onChange:m=>c(m.currentTarget.value),...i})},ne=({name:e,label:a,rules:r,help:n,className:s,...i})=>l(o,{name:e,label:a,rules:r,help:n,className:[s,"kw-tel-wrapper"].join(" "),children:l(re,{name:e,rules:r,...i})}),se=({min:e,max:a,value:r,rules:n,name:s,pattern:i,checked:t,...c})=>l("input",{name:s,type:"number",className:"input",value:r,rules:n,min:e,max:a,...c}),ie=({name:e,label:a,rules:r,help:n,className:s,...i})=>l(o,{name:e,label:a,rules:r,help:n,className:[s,"kw-tel-wrapper"].join(" "),children:l(se,{name:e,rules:r,...i})}),te={select:e=>l(H,{...e}),text:e=>l(w,{...e}),textarea:e=>l(P,{...e}),password:e=>l(w,{...e}),email:e=>l(w,{...e}),file:e=>l(J,{...e}),date:e=>l(Q,{...e}),datepicker:e=>l(W,{...e}),hidden:e=>l(w,{...e}),checkbox:e=>l(C,{...e}),checkboxGroup:e=>l(_,{...e}),radio:e=>l(G,{...e}),time:e=>l(ee,{...e}),"datetime-local":e=>l(Y,{...e}),tel:e=>l(ae,{...e}),range:e=>l(ne,{...e}),number:e=>l(ie,{...e})};function $(e){return(0,te[e.type])({...e,key:e.name})}const me=({id:e,data:a,action:r,handler:n})=>{var N,h,k;const s=j(null),i=r??`https://kwes.io/api/foreign/forms/${e}`,t=a.disclaimer,c=((N=a.submission)==null?void 0:N.button)||"Submit",m=((h=a.submission)==null?void 0:h.success)||null,p=((k=a.submission)==null?void 0:k.error)||null;return l("form",{className:"kwes-form",...r?null:{method:"POST"},...r?null:{noValidate:!0},acceptCharset:"utf-8",ref:s,action:i,...n&&{onSubmit:n},...m&&{"success-message":m},...p&&{"error-message":p},children:a&&u("fieldset",{className:"container",children:[a.title&&u("legend",{children:[l("h2",{children:a.title}),a.subTitle&&l("p",{children:a.subTitle})]}),a.fields&&(b=a.fields,b.map((v,q)=>{const O=Object.keys(v)[0]==="group",F=v.type==="hidden";let T;const y=[];return O?(v.group.forEach((d,D)=>{T=d.field.name;const z=d!=null&&d.size?["column",`is-${d.size}`]:["column"];y.push(l("div",{className:z.join(" "),children:$(d.field)},`group-${D}`))}),l("div",{className:"columns",children:y&&y.map(d=>d)},`group-column-${T}`)):F===!1&&O===!1?l("div",{className:"columns",children:l("div",{className:"column",children:$(v)})},`group-${q}`):l("div",{className:"hidden",children:$(v)},`field-${q}`)})),l("div",{className:"field is-grouped is-grouped-centered",children:l("p",{className:"control",children:l("button",{"data-testid":"submit-button",className:"button is-info is-primary is-fullwidth submit-button is-medium",type:"submit",children:c})})}),t&&l("div",{className:"columns",children:l("div",{className:"column",children:l("p",{className:"disclaimer",dangerouslySetInnerHTML:{__html:t}})})})]})});var b};export{me as default};
