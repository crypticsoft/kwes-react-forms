import{jsxs as u,jsx as l}from"react/jsx-runtime";import*as T from"react";import x,{forwardRef as L,useRef as j,Fragment as F}from"react";const g=({help:e,children:a})=>u("div",{className:"field",children:[l("div",{className:"control",children:a}),e&&l("p",{className:"help",children:e})]}),R=({className:e,help:a,label:s,...r})=>l(g,{help:a,label:s,children:u("label",{className:e,children:[r.children," Â ",s]})}),A=({value:e,rules:a,name:s,checked:r,...i})=>l("input",{name:s,type:"checkbox",checked:r,value:e,...i}),z=({name:e,label:a,rules:s,help:r,className:i,...n})=>l(R,{name:e,label:a,rules:s,help:r,className:i,children:l(A,{name:e,...n})}),G=e=>{var s;T.useState(new Array(Object.entries(e.options).length).fill(!1));const a=(s=e==null?void 0:e.rules)!=null&&s.includes("required")?"label required":"label";return l(g,{label:e.label,help:e.help,children:u("fieldset",{"data-kw-group":!0,className:"kw-checkbox-group",rules:e.rules,children:[l("legend",{className:a,children:e.label}),e.options&&Object.entries(e.options).map(([r,i],n)=>l(z,{name:e.name,value:i,label:r},`${e.name}-${n}`))]})})};function O(e){const[a,s]=T.useState(!1);return T.useEffect(()=>{const r=new MutationObserver(function(i){for(const n of i)n.type==="attributes"&&(n.target.classList.contains("kw-border-error")&&s(!0),n.target.classList.contains("kw-border-success")&&s(!1))});return e.current&&r.observe(e.current,{attributes:!0,childList:!1,subtree:!1}),()=>{r.disconnect()}}),a}const D=L((e,a)=>l("input",{ref:a,id:`${e.name}-input`,"data-testid":`${e.name}-input`,className:["input",e.className?e.className:""].join(" ").trim(),...e}));D.displayName="InputField";const y=e=>{var n,t;const a=j(null),s=O(a),r={"aria-describedby":`field-error-${e.name}`,"aria-invalid":s||""},i=(n=e==null?void 0:e.rules)!=null&&n.includes("required")?"label required":"label";return l(g,{label:e.label,help:e.help,children:u(F,{children:[e.type!=="hidden"&&l("label",{className:i,htmlFor:`${e.name}-input`,children:e.label}),l(D,{ref:a,id:`${e.name}-input`,"data-testid":`${e.name}-input`,rules:e.rules,...e.type!=="hidden"&&s&&{...r},...e,className:["input",e.className,"pl-2"].join(" ").trim(),required:!!((t=e==null?void 0:e.rules)!=null&&t.includes("required"))})]})})},H=({name:e,label:a,onChange:s,value:r})=>l("div",{className:"control",children:u("label",{children:[l("input",{onChange:s,type:"radio",name:e,value:r})," ",a]},a)}),P=e=>{var s;const a=(s=e==null?void 0:e.rules)!=null&&s.includes("required")?"label required":"label";return u("div",{className:"field",children:[l("div",{className:"control radio-control",children:u("fieldset",{"data-kw-group":!0,...e.rules&&{rules:e.rules},children:[l("legend",{className:a,children:e.label}),e.options&&Object.entries(e.options).map(([r,i])=>l("div",{className:"field",children:l(H,{label:r,name:e.name,value:i,onChange:e.onChange})},r))]})}),e.help&&l("p",{className:"help",children:e.help})]})},V=L((e,a)=>l("select",{ref:a,id:`${e.name}-select`,"data-testid":`${e.name}-select`,className:["select",e.className?e.className:"",!(e!=null&&e.multiple)].join(" ").trim(),...e,children:e.children}));V.displayName="SelectField";const B=({name:e,className:a,type:s,label:r,rules:i,defaultOption:n,multiple:t,size:c,help:m,options:p})=>{const[d,f]=x.useState(n||""),b=j(null),k=O(b),w={"aria-describedby":`field-error-${e}`,"aria-invalid":k||""},N=i!=null&&i.includes("required")?"label required":"label";return l(g,{label:r,help:m,children:u(F,{children:[s!=="hidden"&&l("label",{className:N,htmlFor:`${e}-input`,children:r}),l("div",{className:`control is-fullwidth select ${t?"is-multiple":""} ${k?"has-error is-danger":""} ${a||""}`,children:u(V,{ref:b,id:`${e}-select`,name:e,rules:i,onChange:v=>f(v.currentTarget.value),...d&&!t&&!n&&{value:d},...t&&{multiple:t},...t&&c&&{size:c},...w,children:[!n&&l("option",{value:"",children:"Select One"}),n!==void 0&&typeof n=="object"&&l("option",{value:Object.values(n)[0].value,selected:!0,children:Object.keys(n)[0]}),Object.entries(p).map(([v,$])=>l("option",{value:$.value,children:v},v))]})})]})})},J=({name:e,rules:a,label:s,help:r,className:i,...n})=>{const[t,c]=x.useState(n.defaultValue||""),m=j(null),p=O(m),d={"aria-describedby":`field-error-${e}`},f=a!=null&&a.includes("required")?"label required":"label";return u(g,{help:r,label:s,children:[n.type!=="hidden"&&l("label",{className:f,htmlFor:`${e}-input`,children:s}),l("textarea",{ref:m,id:`${e}-textarea`,"data-testid":`${e}-textarea`,name:e,className:["textarea",n.type,i,"pl-2"].join(" "),onChange:b=>c(b.currentTarget.value),...a?{rules:a}:{},...p?{...d}:{},placeholder:n.placeholder,rows:n.rows||void 0,value:t||""})]})},h=({className:e,help:a,label:s,...r})=>u(g,{help:a,label:s,children:[l("label",{className:[e,"label"].join(" "),htmlFor:r.name,children:s}),l("div",{children:r.children})]}),K=({value:e,rules:a,name:s,checked:r,...i})=>l("input",{name:s,type:"file",className:"input",value:e,rules:a,...i}),Q=({name:e,label:a,rules:s,help:r,className:i,...n})=>l(h,{name:e,label:a,rules:s,help:r,className:i,children:l(K,{name:e,rules:s,...n})}),U=({min:e,max:a,value:s,rules:r,name:i,checked:n,...t})=>l("input",{name:i,type:"date",className:"input pl-2",value:s,min:e,max:a,rules:r,...t}),W=({name:e,label:a,rules:s,help:r,className:i,...n})=>l(h,{name:e,label:a,rules:s,help:r,className:[i,"kw-datepicker-wrapper"].join(" "),children:l(U,{name:e,rules:s,...n})}),X=({value:e,rules:a,name:s,checked:r,...i})=>l("div",{className:"kw-datepicker-wrapper",children:l("input",{name:s,type:"datepicker",value:e,className:"input pl-2",rules:a,...i})}),Y=({name:e,label:a,rules:s,help:r,className:i,...n})=>l(h,{name:e,label:a,rules:s,help:r,className:i,children:l(X,{name:e,rules:s,...n})}),Z=({min:e,max:a,rules:s,name:r,...i})=>{const[n,t]=x.useState(null);return l("input",{type:"datetime-local",className:"input pl-2",name:r,value:n||"",min:e,max:a,rules:s,onChange:c=>t(c.currentTarget.value),...i})},ee=({name:e,min:a,max:s,label:r,rules:i,help:n,className:t,...c})=>l(h,{name:e,label:r,rules:i,help:n,className:[t,"kw-datepicker-wrapper"].join(" "),children:l(Z,{name:e,min:a,rules:i,max:s,...c})}),le=({min:e,max:a,value:s,rules:r,name:i,checked:n,...t})=>l("input",{name:i,type:"time",className:"input timepicker",value:s,min:e,max:a,rules:r,...e&&a&&{title:`Time should be between ${new Date(`${new Date().toLocaleString().split(",").shift()} ${e}`).toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0})} and ${new Date(`${new Date().toLocaleString().split(",").shift()} ${a}`).toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0})}`},...t}),ae=({name:e,label:a,rules:s,help:r,className:i,...n})=>l(h,{name:e,label:a,rules:s,help:r,className:[i,"kw-timepicker-wrapper"].join(" "),children:l(le,{name:e,rules:s,...n})}),se=({help:e,value:a,name:s,pattern:r,checked:i,...n})=>l("input",{name:s,type:"tel",className:["input input-tel",n==null?void 0:n.className,"pl-2"].join(" ").trim(),value:a,pattern:r,"aria-label":e,...n}),re=({name:e,rules:a,label:s,help:r,className:i,...n})=>l(h,{name:e,label:s,help:r,className:[i,"kw-tel-wrapper",a!=null&&a.includes("required")?"required":""].join(" "),children:l(se,{name:e,help:r,...n})}),ne=({defaultValue:e,min:a,max:s,value:r,rules:i,name:n,pattern:t,...c})=>l("input",{name:n,type:"number",className:["input",c==null?void 0:c.className,"pl-2"].join(" ").trim(),value:r??e,rules:i,min:a,max:s,...c}),E=({min:e,max:a,step:s,name:r,label:i,rules:n,help:t,className:c,...m})=>l(h,{name:r,label:i,rules:n,help:t,className:[c,"kw-tel-wrapper"].join(" "),children:l(ne,{min:e,max:a,step:s,name:r,rules:n,...m})}),ie=({defaultValue:e,min:a,max:s,step:r,rules:i,name:n,checked:t,...c})=>{const[m,p]=x.useState(e??"");return u("div",{className:"range-input-wrapper",children:[l("input",{name:n,className:"range-input",type:"range",value:m,...i&&{rules:i},...a&&{min:a},...s&&{max:s},...r&&{step:r},onChange:d=>p(d.currentTarget.value),...c}),l(E,{onChange:d=>p(d.currentTarget.value),...c,id:`${n}-input`,type:"number","data-testid":`${n}-input`,value:m,rules:i,required:!!(i!=null&&i.includes("required"))})]})},te=({name:e,label:a,rules:s,help:r,className:i,...n})=>l(h,{name:e,label:a,rules:s,help:r,className:[i,"kw-tel-wrapper"].join(" "),children:l(ie,{name:e,rules:s,...n})}),ce={select:e=>l(B,{...e}),text:e=>l(y,{...e}),textarea:e=>l(J,{...e}),password:e=>l(y,{...e}),email:e=>l(y,{...e}),file:e=>l(Q,{...e}),date:e=>l(W,{...e}),datepicker:e=>l(Y,{...e}),hidden:e=>l(y,{...e}),checkbox:e=>l(z,{...e}),checkboxGroup:e=>l(G,{...e}),radio:e=>l(P,{...e}),time:e=>l(ae,{...e}),"datetime-local":e=>l(ee,{...e}),tel:e=>l(re,{...e}),range:e=>l(te,{...e}),number:e=>l(E,{...e})};function S(e){return(0,ce[e.type])({...e,key:e.name})}const de=({id:e,data:a,action:s,handler:r,method:i="POST"})=>{var b,k,w;const n=j(null),t=s??`https://kwes.io/api/foreign/forms/${e}`,c=a.disclaimer,m=((b=a.submission)==null?void 0:b.button)||"Submit",p=((k=a.submission)==null?void 0:k.success)||null,d=((w=a.submission)==null?void 0:w.error)||null;return l("form",{className:"kwes-form",...a?null:{method:i},...s?null:{noValidate:!0},acceptCharset:"utf-8",ref:n,action:t,...r&&{onSubmit:r},...p&&{"success-message":p},...d&&{"error-message":d},children:a&&u("fieldset",{className:"container",children:[a.title&&l("div",{className:"columns",children:u("div",{className:"column",children:[l("span",{className:"h2",children:a.title}),l("br",{}),a.subTitle&&l("span",{children:a.subTitle})]})}),a.fields&&(f=a.fields,f.map((N,v)=>{const $=Object.keys(N)[0]==="group",I=N.type==="hidden";let C;const q=[];return $?(N.group.forEach((o,M)=>{C=o.field.name;const _=o!=null&&o.size?["column",`is-${o.size}`]:["column"];q.push(l("div",{className:_.join(" "),children:S(o.field)},`group-${M}`))}),l("div",{className:"columns",children:q&&q.map(o=>o)},`group-column-${C}`)):I===!1&&$===!1?l("div",{className:"columns",children:l("div",{className:"column",children:S(N)})},`group-${v}`):l("div",{className:"hidden",children:S(N)},`field-${v}`)})),l("div",{className:"field is-grouped is-grouped-centered",children:l("p",{className:"control",children:l("button",{"data-testid":"submit-button",className:"button is-info is-primary is-fullwidth submit-button is-normal",type:"submit",children:m})})}),c&&l("div",{className:"columns",children:l("div",{className:"column",children:l("p",{className:"disclaimer",dangerouslySetInnerHTML:{__html:c}})})})]})});var f};export{de as default};
